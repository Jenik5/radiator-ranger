<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Radiátor Ranger – Dokumentace ovládacích prvků, senzorů konfigurace</title>
<style>
    body {
        font-family: Arial, Helvetica, sans-serif;
        line-height: 1.6;
        max-width: 900px;
        margin: auto;
        padding: 20px;
    }
    h1, h2, h3 {
        margin-top: 1.4em;
    }
    img {
        border: 1px solid #ddd;
        border-radius: 6px;
        margin: 10px 0;
    }
</style>
</head>

<body>

<h1>Radiátor – Dokumentace ovládacích prvků a senzorů</h1>

<h2>Ovládací prvky</h2>

<img src="/images/ovladaci_prvky.png" width="600" alt="Ovládací prvky">

<h3>Boost (minuty)</h3>
<p>
Slouží k okamžitému přetlačení regulace termostatu a k aktivaci topení na maximální výkon po zadanou dobu.
Během Boostu termostat dál normálně reguluje a pokud se mezitím změní režim (např. schedulerem), po ukončení Boostu bude pokračovat v aktuálně platném režimu.
</p>

<h3>Boost nekonečný</h3>
<p>
Aktivuje nepřetržité nucené topení na maximální výkon, dokud není režim ručně ukončen.
Používá se, pokud je třeba topit naplno bez časového omezení.
</p>

<h3>Stav topení (ovládací prvek)</h3>
<p>
Otevře detail termostatu, který umožňuje:
</p>
<ul>
    <li>sleduje aktuální teplotu,</li>
    <li>upravuje cílovou teplotu,</li>
    <li>zobrazuje stav (topení / nečinný),</li>
    <li>přepíná režimy.</li>
</ul>
<p>
Speciální interní stavy (např. Boost, větrání) se zde nezobrazují — ty poskytuje textový senzor.
</p>

<img src="/images/termostat.png" width="600" alt="Termostat detail">

<hr>

<h2>Senzory</h2>

<img src="/images/sensory.png" width="600" alt="Senzory">

<h3>Požadavek na topení</h3>
<p>
Číselná hodnota <strong>0.0 nebo 1.0</strong>:
</p>
<ul>
    <li><strong>0.0</strong> znamená, že termostat topení nepožaduje,</li>
    <li><strong>1.0</strong> znamená aktivní požadavek.</li>
</ul>
<p>
Je to takto navrženo proto, aby bylo možné snadno sečíst požadavky z více radiátorů a zjistit,
kolik zařízení chce aktuálně topit.
Příklad součtového senzoru je uveden v <code>/HomeAssistant/template.yaml</code>.
</p>

<h3>Stav topení (textový senzor)</h3>
<p>
Podrobný textový popis toho, co termostat právě dělá. Zahrnuje například:
</p>
<ul>
    <li><strong>„Zapnuto – 15,7 °C – Doma“</strong></li>
    <li><strong>„Vypnuto – Boost“</strong></li>
    <li><strong>„Vypnuto – Otevřené okno“</strong></li>
    <li><strong>„Neaktivní – Mimo topnou sezónu“</strong></li>
</ul>
<p>
Senzor se používá zejména v ovládacích panelech pomocí card-mod (viz <code>/HomeAssistant/tile.yaml</code>).
</p>

<h3>Teplota pro regulaci</h3>
<p>
Teplota, kterou termostat skutečně používá pro regulaci. Zdroje mají tuto prioritu:
</p>
<ol>
    <li><strong>Externí teplota</strong> z HA</li>
    <li><strong>Interní prostorová teplota</strong> (fallback)</li>
    <li><strong>Nouzová hodnota 0 °C</strong></li>
</ol>

<hr>

<h2>Diagnostika</h2>

<img src="/images/diagnostika.png" width="600" alt="Diagnostika">

<h3>Boost aktivní</h3>
<p>
Zobrazuje, zda právě probíhá časový nebo nekonečný Boost, případně kolik času zbývá.
</p>

<h3>Otevřené okno (větrání)</h3>
<p>
Externí signál z Home Assistantu, již se zpožděním filtrovaný (2 min při otevření, 10 s při zavření).  
Má přímý vliv na chování termostatu — <strong>převezme řízení a radiátor vypne</strong>.  
Boost má vyšší prioritu, takže jeho aktivace otevřené okno přebije.
</p>

<h3>Teplota prostoru (fallback)</h3>
<p>
Interní teplota z DS18B20 v těle zařízení. Používá se při výpadku externího senzoru.
</p>

<h3>Teplota radiátoru (diag)</h3>
<p>
Interní teplota tělesa radiátoru (DS18B20). Zároveň slouží jako ochrana proti zamrznutí.
</p>

<h3>Topná sezóna</h3>
<p>
Externí binární signál z Home Assistantu.  
Slouží k odlehčení ventilu i aktuátoru v době, kdy je celé topení mimo provoz.  
Mimo topnou sezónu je ventil ponechán <strong>otevřený</strong>, protože zavírání by způsobovalo mechanické namáhání a aktuátor by navíc trvale odebíral přibližně <strong>7 W</strong> energie.
</p>
<p>
Topná sezóna má vyšší prioritu než Boost — pokud je mimo sezónu, bude ventil otevřený i při aktivním Boostu.
</p>

<h3>Uptime</h3>
<p>
Čas od posledního restartu.
</p>

<h3>WiFi RSSI</h3>
<p>
Síla WiFi signálu v dBm.
</p>

</body>
</html>
